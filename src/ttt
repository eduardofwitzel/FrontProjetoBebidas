import React from 'react';
import axios from 'axios';
//import {BrowserRouter} from 'react-router-dom'

//import Routes from './Routes'
import './App.css';

class TabelaBebidas extends React.Component {
  render(){
    const lista = this.props.state.lista;
    const listaDisplay = [];
    for (let i=0; i < lista.length;i++) {
      listaDisplay.push(
        <tr>
          <td>{lista[i].id}</td>
          <td>{lista[i].marca} </td>
          <td>{lista[i].valor} </td>
          <td>{lista[i].tipo} </td>
          <td>{lista[i].volume} </td>
        </tr>
      );
    }

    return (
      <div>
          <h2>Tabela de Bebidas</h2>
          <table className="table table-striped">
            <thead>
              <tr>
                <th>id</th>
                <th>marca</th>
                <th>valor</th>
                <th>tipo</th>
                <th>volume</th>
              </tr>
            </thead>
            <tbody>
            {listaDisplay}
            </tbody>
          </table>
      </div>    
    );
  }
  }

  function LabelInput(props){
    return(
      <div className="form-group">
        <label>{props.label}</label>
        <input type="TEXT" value={props.value} 
                className="form-control"
                onChange={(e) => {
                  if (props.atualizarTexto){
                  props.atualizarTexto(e.target.value);
                  }
                  }}/>
      </div>
  
    );
  }
  
  class App extends React.Component {
    state = {
      BebidaAtual: {
        id: "",
        marca: "",
        valor: "",
        tipo: "",
        volume: ""
      },
      lista: [
      
      ]
  }
  
  componentDidMount() {
      axios.get(
          `http://localhost:8080/bebida`,
          {
            responseType: 'json',
          }
        ).then(
        (response) => {
          const novoState = {...this.state};
          novoState.lista = response.data;
          this.setState(novoState);
        }
        );
        console.log("Bebidas carregadas");
  }
  
  atualizarTexto(campo, txt){
      const novoState = {...this.state};
      novoState.BebidaAtual[campo] = txt;
      this.setState(novoState);
  }
  
  gravar(){ 
      const apiUrl = `http://localhost:8080/bebida/add`;
      fetch(apiUrl, {
        method:'POST',
        headers: {
          Accept: 'text/plain',
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(this.state.BebidaAtual)
      }).then(
        (response)=> {
          console.log(response.body);
          this.componentDidMount();
        }
      );
  }

  editar(){ 
    const apiUrl = `http://localhost:8080/bebida/add`;
    fetch(apiUrl, {
      method:'POST',
      headers: {
        Accept: 'text/plain',
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(this.state.BebidaAtual)
    }).then(
      (response)=> {
        console.log(response.body);
        this.componentDidMount();
      }
    );
}
  
    render(){
      return (
        <div className="container">
          <TabelaBebidas state={this.state}/>
          <h1>Registrar Bebida</h1>
        <LabelInput label="Id:" 
                    value = {this.state.BebidaAtual.id}
                    atualizarTexto={(txt) => this.atualizarTexto('id',txt)}/>
  
        <LabelInput label="marca:"
                    value = {this.state.BebidaAtual.marca}
                    atualizarTexto={(txt) => this.atualizarTexto('marca', txt)}/>
  
        <LabelInput label="valor:"
                    value = {this.state.BebidaAtual.valor}
                    atualizarTexto={(txt) => this.atualizarTexto('valor',txt)}/>
  
        <LabelInput label="tipo:"
                    value = {this.state.BebidaAtual.tipo}
                    atualizarTexto={(txt) => this.atualizarTexto('tipo', txt)}/>
        <LabelInput label="volume:"
                    value = {this.state.BebidaAtual.volume}
                    atualizarTexto={(txt) => this.atualizarTexto('volume',txt)}/>
  
        <button className="btn btn-primary"
          onClick={()=>{this.gravar()}}>Gravar</button>
          
        <button className="btn btn-primary "
          onClick={()=>{this.editar()}}>Editar</button>
        
      </div>
    );
    }
  }
  
  export default App;


ATUALIZAR

import React, { Component } from 'react';
import BebidaService from '../services/BebidaService';

class AtualizarBebida extends Component {
    constructor(props){
        super(props)

        this.state = {
          id: this.props.match.params.id,
          marca: '',
          valor: 0.0,
          tipo: '',
          volume: 0 
        }
        this.changeMarcaHandler = this.changeMarcaHandler.bind(this);
        this.changeValorHandler = this.changeValorHandler.bind(this);
        this.changeTipoHandler = this.changeTipoHandler.bind(this);
        this.changeVolumeHandler = this.changeVolumeHandler.bind(this);
        this.atualizarBebida = this.atualizarBebida.bind(this);
    }

    componentDidMount(){
        BebidaService.getBebidaById(this.state.id).then((res) => {
            let bebida = res.data;
            this.setState({marca: bebida.marca,
                valor: bebida.valor,
                tipo: bebida.tipo,
                volume: bebida.volume
            });
        });
    }

    atualizarBebida = (e) => {
        e.preventDefault();
        let bebida = {marca: this.state.marca, valor: this.state.valor, tipo: this.state.tipo, volume: this.state.volume};
        console.log('bebida => ' + JSON.stringify(bebida));
        BebidaService.updateBebida(bebida, this.state.id).then( res => {
            this.props.history.push('/bebida');
        });
    }

    cancel() {
        this.props.history.push('/bebida');
    }

    changeMarcaHandler = (event) => {
        this.setState({marca: event.target.value});
    }

    changeValorHandler = (event) => {
        this.setState({valor: event.target.value});
    }

    changeTipoHandler = (event) => {
        this.setState({tipo: event.target.value});
    }

    changeVolumeHandler = (event) => {
        this.setState({volume: event.target.value});
    }

    render() {
        return (
            <div>
                <div className = "container">
                    <div className = "row">
                        <div className = "card col-md-6 offset-md-3 offset0-md-3">
                            <h3 className = "text-center"> Editar Bebida </h3>
                            <div className = "card-body">
                                <form>
                                <div className = "form-group">
                                        <label> Marca: </label>
                                        <input placeholder = "Marca" name = "marca" className = "form-control"
                                            value = {this.state.marca} onChange = {this.changeMarcaHandler} style = {{marginBottom: "10px"}}/>
                                    </div>
                                    <div className = "form-group">
                                        <label> Valor: </label>
                                        <input placeholder = "Valor" name = "valor" className = "form-control"
                                            value = {this.state.valor} onChange = {this.changeValorHandler} style = {{marginBottom: "10px"}}/>
                                    </div>
                                    <div className = "form-group">
                                        <label> Tipo: </label>
                                        <input placeholder = "Tipo" name = "tipo" className = "form-control"
                                            value = {this.state.tipo} onChange = {this.changeTipoHandler} style = {{marginBottom: "10px"}}/>
                                    </div>
                                    <div className = "form-group">
                                        <label> Volume: </label>
                                        <input placeholder = "Volume" name = "volume" className = "form-control"
                                            value = {this.state.volume} onChange = {this.changeVolumeHandler} style = {{marginBottom: "10px"}}/>
                                    </div>
                                    <button className = "btn btn-success" onClick = {this.atualizarBebida}>Save</button>
                                    <button className = "btn btn-danger" onClick = {this.cancel.bind(this)} style = {{marginLeft: "10px"}}>Cancel</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        );
    }
}

export default AtualizarBebida;

ADICIONAR

import React, { Component } from 'react';
import BebidaService from '../services/BebidaService';

class CriarBebidaComponent extends Component {
    constructor(props){
        super(props)

        this.state = {
          marca: '',
          valor: 0.0,
          tipo: '',
          volume: 0 
        }
        this.changeMarcaHandler = this.changeMarcaHandler.bind(this);
        this.changeValorHandler = this.changeValorHandler.bind(this);
        this.changeTipoHandler = this.changeTipoHandler.bind(this);
        this.changeVolumeHandler = this.changeVolumeHandler.bind(this);
        this.adicionarBebida = this.adicionarBebida.bind(this);
    }

    adicionarBebida = (e) => {
        e.preventDefault();
        let bebida = {marca: this.state.marca, valor: this.state.valor, tipo: this.state.tipo, volume: this.state.volume};
        console.log('bebida => ' + JSON.stringify(bebida));

        BebidaService.createBebida(bebida).then(res =>{
            this.props.history.push("/bebida");
        });
    }

    cancel() {
        this.props.history.push('/bebida');
    }

    changeMarcaHandler = (event) => {
        this.setState({marca: event.target.value});
    }

    changeValorHandler = (event) => {
        this.setState({valor: event.target.value});
    }

    changeTipoHandler = (event) => {
        this.setState({tipo: event.target.value});
    }

    changeVolumeHandler = (event) => {
        this.setState({volume: event.target.value});
    }

    render() {
        return (
            <div>
                <div className = "container">
                    <div className = "row">
                        <div className = "card col-md-6 offset-md-3 offset0-md-3">
                            <h3 className = "text-center"> Adicionar Bebida </h3>
                            <div className = "card-body">
                                <form>
                                    <div className = "form-group">
                                        <label> Marca: </label>
                                        <input placeholder = "Marca" name = "marca" className = "form-control"
                                            value = {this.state.marca} onChange = {this.changeMarcaHandler} style = {{marginBottom: "10px"}}/>
                                    </div>
                                    <div className = "form-group">
                                        <label> Valor: </label>
                                        <input placeholder = "Valor" name = "valor" className = "form-control"
                                            value = {this.state.valor} onChange = {this.changeValorHandler} style = {{marginBottom: "10px"}}/>
                                    </div>
                                    <div className = "form-group">
                                        <label> Tipo: </label>
                                        <input placeholder = "Tipo" name = "tipo" className = "form-control"
                                            value = {this.state.tipo} onChange = {this.changeTipoHandler} style = {{marginBottom: "10px"}}/>
                                    </div>
                                    <div className = "form-group">
                                        <label> Volume: </label>
                                        <input placeholder = "Volume" name = "volume" className = "form-control"
                                            value = {this.state.volume} onChange = {this.changeVolumeHandler} style = {{marginBottom: "10px"}}/>
                                    </div>
                                    <button className = "btn btn-success" onClick = {this.adicionarBebida}>Save</button>
                                    <button className = "btn btn-danger" onClick = {this.cancel.bind(this)} style = {{marginLeft: "10px"}}>Cancel</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        );
    }
}

export default CriarBebidaComponent;

LISTAR

import React, { Component } from 'react';
import BebidaService from '../services/BebidaService';

class ListarBebidasComponent extends Component {
    constructor(props){
        super(props)

        this.state = {
            bebidas: []
        }
        this.addBebida = this.addBebida.bind(this);
        this.editBebida = this.editBebida.bind(this);
        this.deleteBebida = this.deleteBebida.bind(this);
    }

    componentDidMount(){
        BebidaService.getBebida().then((res) => {
            this.setState({ bebidas: res.data });
        });
    }

    addBebida(){
        this.props.history.push('/add-bebida');
    }

    editBebida(id){
        this.props.history.push(`/update-bebida/${id}`);
    }

    deleteBebida(id){
        BebidaService.deleteBebida(id).then(res => {
            this.setState({bebidas: this.state.bebidas.filter(bebida => bebida.id !== id)});
        });
    }

    render() {
        return (
            <div>
                <h2 className = "text-center">Lista de Bebidas</h2>
                <div className = "row">
                    <button className = "btn btn-primary add" onClick = {this.addBebida} style = {{marginBottom: "10px"}}> Adicionar Bebida </button>
                </div>
                <div className = "row">
                    <table className = "table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th> Marca </th>
                                <th> Valor </th>
                                <th> Tipo </th>
                                <th> Volume </th>
                                <th> Actions </th>
                            </tr>
                        </thead>
                        <tbody>
                            {
                                this.state.bebidas.map(
                                    bebida =>
                                    <tr key = {bebida.id}>
                                        <td> {bebida.marca} </td>
                                        <td> {bebida.valor} </td>
                                        <td> {bebida.tipo} </td>
                                        <td> {bebida.volume} </td>
                                        <td>
                                            <button onClick = {() => this.editBebida(bebida.id)} className = "btn btn-info"> Atualizar </button>
                                            <button style = {{marginLeft: "10px"}} onClick = {() => this.deleteBebida(bebida.id)} className = "btn btn-danger"> Deletar </button>
                                        </td>
                                    </tr>
                                )
                            }

                        </tbody>

                    </table>

                </div>

            </div>
        );
    }
}

export default ListarBebidasComponent;

SERVICE

import axios from 'axios';

const BEBIDA_API_BASE_URL = "http://localhost:8080/api/bebida";

class BebidaService {

    getBebida(){
        return axios.get(BEBIDA_API_BASE_URL);
    }

    createBebida(bebida){
        return axios.post(BEBIDA_API_BASE_URL, bebida);
    }

    getBebidaById(bebidaId){
        return axios.get(BEBIDA_API_BASE_URL + '/' + bebidaId);
    }


    updateBebida(bebida, bebidaId){
        return axios.put(BEBIDA_API_BASE_URL + '/' + bebidaId, bebida);
    }

    deleteBebida(bebidaId){
        return axios.delete(BEBIDA_API_BASE_URL + '/' + bebidaId);
    }
}

export default new BebidaService()


import './App.css';
import {BrowserRouter as Router, Route, Switch} from 'react-router-dom';
import ListarBebidasComponent from './components/ListarBebidasComponent';
import CriarBebidaComponent from './components/CriarBebidaComponent';
import AtualizarBebida from './components/AtualizarBebida';

function App() {
  return (
    <div>
      <Router>
            <div className = "container">
              <Switch> 
                <Route path = "/" exact component = {ListarBebidasComponent}></Route>
                <Route path = "/bebida" component = {ListarBebidasComponent}></Route>
                <Route path = "/add-bebida" component = {CriarBebidaComponent}></Route>
                <Route path = "/update-bebida/:id" component = {AtualizarBebida}></Route>
              </Switch>
            </div>
      </Router>
    </div>
  );
}

export default App;




